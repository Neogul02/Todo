<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>캘린더 투두리스트</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .calendar-table {
            width: 100%;
            table-layout: fixed;
        }
        .calendar-table th, .calendar-table td {
            width: 14.28%;
            height: 80px;
            text-align: center;
            vertical-align: middle;
        }
        .calendar-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .btn-calendar {
            width: 100%;
            height: 60px;
        }
        .today {
            background: #ffe066 !important;
        }
    </style>
</head>
<body class="bg-light p-4">

<div class="container w-50">
    <!-- 월 변경 -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <a href="/todos?year={{prevYear}}&month={{prevMonth}}" class="btn btn-outline-secondary">← 이전달</a>
        <h3 class="m-0 text-center">{{selectedYear}}년 {{selectedMonth}}월</h3>
        <a href="/todos?year={{nextYear}}&month={{nextMonth}}" class="btn btn-outline-secondary">다음달 →</a>
    </div>

    <!-- 달력 테이블 -->
    <table class="calendar-table mb-4">
        <thead>
        <tr>
            <th>월</th>
            <th>화</th>
            <th>수</th>
            <th>목</th>
            <th>금</th>
            <th class="text-primary">토</th>
            <th class="text-danger">일</th>
        </tr>
        </thead>
        <tbody>
        {{#calendarRows}}
            <tr>
                {{#this}}
                    <td>
                        {{#day}}
                            <a href="/todos?date={{date}}" class="btn btn-calendar {{#isToday}}today{{/isToday}} {{^isToday}}btn-outline-primary{{/isToday}}">
                            {{day}}
                            </a>
                        {{/day}}
                    </td>
                {{/this}}
            </tr>
        {{/calendarRows}}
        </tbody>
    </table>

    <!-- 선택 날짜 -->
    <h5 class="text-center mb-3">{{selectedDate}}의 할 일</h5>

    <!-- 추가 폼 -->
    <form action="/todos/add" method="post" class="d-flex mb-3">
        <input type="hidden" name="date" value="{{selectedDate}}">
        <input type="text" name="title" class="form-control me-2" placeholder="할 일을 입력하세요" required>
        <button type="submit" class="btn btn-success" style="white-space: nowrap;">추가</button>
    </form>

    <!-- 투두 리스트 -->
    <ul class="list-group">
        {{#todos}}
            <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="{{#completed}}text-decoration-line-through text-muted{{/completed}}">
                {{title}}
            </span>
                <div>
                    <form action="/todos/toggle/{{id}}" method="post" class="d-inline">
                        <input type="hidden" name="date" value="{{date}}">
                        <button class="btn btn-sm btn-primary">완료</button>
                    </form>
                    <form action="/todos/delete/{{id}}" method="post" class="d-inline">
                        <input type="hidden" name="date" value="{{date}}">
                        <button class="btn btn-sm btn-danger">삭제</button>
                    </form>
                </div>
            </li>
        {{/todos}}
    </ul>
</div>

</body>
</html>